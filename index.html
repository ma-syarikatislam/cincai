<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Progres Hafalan Juz 30</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 1rem;
      background: #f9f9f9;
    }
    h2 {
      margin-top: 2rem;
      margin-bottom: 0.5rem;
    }
    ol {
      padding-left: 1.5rem;
    }
    .done-j {
      background-color: #a5d6a7;
      color: #000;
      font-weight: bold;
      padding: 4px 8px;
      border-radius: 5px;
    }
    .done-m {
      position: relative;
      color: #fff8e1;
      font-weight: bold;
      padding: 4px 8px;
      border-radius: 5px;
      overflow: hidden;
      background: linear-gradient(135deg, #ffd700, #ffeb3b, #ffd700);
      background-size: 200% 200%;
      animation: shimmer 2.5s infinite linear;
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
    }
    @keyframes shimmer {
      0% {
        background-position: -200% 0;
      }
      100% {
        background-position: 200% 0;
      }
    }
    .full-marks {
      font-weight: bold;
      background: linear-gradient(135deg, #ffe57f, #ffca28, #ffe57f);
      background-size: 300% 300%;
      animation: shimmer 3s infinite linear;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .medal {
      font-size: 1.2em;
      margin-left: 8px;
    }
    .toggle-btn {
      background-color: #4caf50;
      color: white;
      border: none;
      padding: 8px 16px;
      margin: 10px 0;
      cursor: pointer;
      border-radius: 5px;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>

<h1>Progres Hafalan Juz 30</h1>

<!-- Leaderboard -->
<h2>üèÜ Leaderboard Hafalan</h2>
<ol id="leaderboardList"></ol>

<!-- Tombol untuk menampilkan pie chart -->
<button class="toggle-btn" onclick="toggleSection()">Tampilkan Statistik Lengkap</button>

<!-- Bagian Pie + siswa kosong (awalnya tersembunyi) -->
<div id="statistikSection" class="hidden">
  <h2>üìä Statistik Hafalan</h2>
  <canvas id="myChart" width="400" height="400"></canvas>

  <h2>üôà Belum Setor Sama Sekali</h2>
  <ul id="belumSetorList"></ul>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const data = {
    labels: ["An-Naba", "An-Nazi'at", "Abasa", "At-Takwir", "Al-Infitar"],
    siswa: [
      { nama: "Ali", nilai: ["M", "J", "M", "J", "M"] },
      { nama: "Dina", nilai: ["J", "J", "M", "M", "J"] },
      { nama: "Fikri", nilai: ["", "", "", "", ""] },
      { nama: "Salma", nilai: ["M", "M", "M", "M", "M"] }, // 100%
    ]
  };

  const leaderboardList = document.getElementById("leaderboardList");
  const belumSetorList = document.getElementById("belumSetorList");

  let chartData = {
    M: 0,
    J: 0,
    kosong: 0
  };

  // Leaderboard & belum setor
  data.siswa.forEach(s => {
    let total = s.nilai.length;
    let isi = s.nilai.filter(x => x === "M" || x === "J").length;

    if (isi === 0) {
      const li = document.createElement("li");
      li.textContent = s.nama;
      belumSetorList.appendChild(li);
      chartData.kosong++;
    } else {
      const li = document.createElement("li");
      if (isi === total) {
        li.innerHTML = `<span class="full-marks">${s.nama}</span><span class="medal">ü•á</span> - ${isi} surat`;
      } else {
        li.innerHTML = `${s.nama} - ${isi} surat`;
      }
      leaderboardList.appendChild(li);
    }

    s.nilai.forEach(n => {
      if (n === "M") chartData.M++;
      if (n === "J") chartData.J++;
    });
  });

  const ctx = document.getElementById("myChart").getContext("2d");
  let myChart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: ['Mumtaz (M)', 'Jayyid (J)', 'Belum Setor'],
      datasets: [{
        label: 'Distribusi Hafalan',
        data: [chartData.M, chartData.J, chartData.kosong],
        backgroundColor: [
          '#ffd700',
          '#66bb6a',
          '#e0e0e0'
        ]
      }]
    },
    options: {
      responsive: true
    }
  });

  function toggleSection() {
    const section = document.getElementById("statistikSection");
    section.classList.toggle("hidden");
  }
</script>
</body>
</html>
