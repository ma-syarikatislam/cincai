<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Presensi QR</title>
</head>
<body>
  <h1>Presensi Siswa</h1>

  <button id="send">Kirim Data</button>
  <ul id="log"></ul>

  <script>
    const dataKehadiran = [];

    // Simulasi data dari QR
    function simpanPresensi(nama) {
      const waktu = new Date().toLocaleString("id-ID");
      dataKehadiran.push({ nama, waktu });

      const li = document.createElement("li");
      li.textContent = `${nama} - ${waktu}`;
      document.getElementById("log").appendChild(li);
    }

    // Contoh input manual
    simpanPresensi("20280454-Rizky");
    simpanPresensi("20280455-Dewi");

    document.getElementById("send").addEventListener("click", () => {
      if (dataKehadiran.length === 0) {
        alert("Belum ada data kehadiran.");
        return;
      }

      const scriptURL = "https://script.google.com/macros/s/AKfycbwhT3NnxRKiQfWc-4hKQJD7bYLK0DWpe5ZLtO7sFSnlVhz9Mkku9CK-BTkHNF_DQ78t/exec";

      fetch(scriptURL, {
        method: "POST",
        body: JSON.stringify(dataKehadiran),
        headers: {
          "Content-Type": "application/json"
        }
      })
      .then(res => res.text())
      .then(result => {
        alert("✅ " + result);
      })
      .catch(err => {
        console.error("Gagal kirim:", err);
        alert("❌ Gagal mengirim data.");
      });
    });
  </script>
</body>
</html>
