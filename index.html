<!DOCTYPE html>
<html>
  <head>
    <title>Scan QR ke Google Sheets</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style> body { font-family: sans-serif } </style>
  </head>
  <body>
    <h3>Scan QR Code</h3>
    <div id="reader" style="width:320px"></div>
    <div id="result"></div>

    <script>
      function onScanSuccess(decodedText, decodedResult) {
        document.getElementById('result').innerText = "Scan berhasil: " + decodedText;
        // Kirim ke Apps Script
        google.script.run
          .withSuccessHandler(function(msg){
            document.getElementById('result').innerText += "\nTerkirim ke Sheets!";
          })
          .withFailureHandler(function(err){
            document.getElementById('result').innerText += "\nGagal: "+err;
          })
          .processQR(decodedText);

        html5QrcodeScanner.clear();  // Stop scanning setelah scan
      }

      let html5QrcodeScanner = new Html5QrcodeScanner(
        "reader", { fps: 10, qrbox: 250 });
      html5QrcodeScanner.render(onScanSuccess);
    </script>
  </body>
</html>
